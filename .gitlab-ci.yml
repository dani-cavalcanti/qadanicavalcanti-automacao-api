image: maven:latest

stages:
 - build
 - test
 - package
 - deploy
 - liquibase
 - liquibase_rollback

build:
 stage: build
 script:
   - mvn compile

test:
 stage: test
 script:
   - mvn test

deploy:
 stage: deploy
 dependencies:
   - build
   - test
   - package
 image: anardy/wildfly
 before_script:
   - chmod +x ./deploy.sh
 script:
   - ./deploy.sh
